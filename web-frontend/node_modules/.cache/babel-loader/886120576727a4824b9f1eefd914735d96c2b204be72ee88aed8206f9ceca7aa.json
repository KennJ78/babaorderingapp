{"ast":null,"code":"const HISTORY_KEY = 'reservationsHistory';\nclass ReservationHistoryService {\n  static list() {\n    try {\n      const raw = localStorage.getItem(HISTORY_KEY);\n      return raw ? JSON.parse(raw) : [];\n    } catch (e) {\n      return [];\n    }\n  }\n  static save(list) {\n    localStorage.setItem(HISTORY_KEY, JSON.stringify(list));\n    ReservationHistoryService.notifyUpdated();\n  }\n  static notifyUpdated() {\n    try {\n      window.dispatchEvent(new Event('reservationHistoryUpdated'));\n    } catch (_) {}\n  }\n  static generateCode() {\n    return 'RSV-' + Math.random().toString(36).substring(2, 8).toUpperCase();\n  }\n  static addReservation({\n    items,\n    subtotal\n  }) {\n    const list = ReservationHistoryService.list();\n    const code = ReservationHistoryService.generateCode();\n    const id = `${Date.now()}`;\n    const date = new Date().toISOString();\n    const reservation = {\n      id,\n      code,\n      date,\n      status: 'Processing',\n      deliveryFee: 0,\n      subtotal,\n      total: subtotal,\n      items: items.map(i => ({\n        id: i.id,\n        name: i.name,\n        price: i.price,\n        qty: i.qty || 1,\n        imagePath: i.imagePath\n      }))\n    };\n    list.unshift(reservation);\n    ReservationHistoryService.save(list);\n\n    // Simulate status progression\n    setTimeout(() => {\n      ReservationHistoryService.updateStatus(id, 'Confirmed');\n    }, 5000);\n    setTimeout(() => {\n      ReservationHistoryService.updateStatus(id, 'Ready for Pickup');\n    }, 12000);\n    return reservation;\n  }\n  static updateStatus(id, status) {\n    const list = ReservationHistoryService.list();\n    const idx = list.findIndex(r => r.id === id);\n    if (idx >= 0) {\n      list[idx] = {\n        ...list[idx],\n        status\n      };\n      ReservationHistoryService.save(list);\n    }\n  }\n  static getByCode(code) {\n    return ReservationHistoryService.list().find(r => r.code === code) || null;\n  }\n}\nexport default ReservationHistoryService;","map":{"version":3,"names":["HISTORY_KEY","ReservationHistoryService","list","raw","localStorage","getItem","JSON","parse","e","save","setItem","stringify","notifyUpdated","window","dispatchEvent","Event","_","generateCode","Math","random","toString","substring","toUpperCase","addReservation","items","subtotal","code","id","Date","now","date","toISOString","reservation","status","deliveryFee","total","map","i","name","price","qty","imagePath","unshift","setTimeout","updateStatus","idx","findIndex","r","getByCode","find"],"sources":["C:/Users/Daenerys/Downloads/babaorderingapp/web-frontend/src/services/ReservationHistoryService.js"],"sourcesContent":["const HISTORY_KEY = 'reservationsHistory';\r\n\r\nclass ReservationHistoryService {\r\n  static list() {\r\n    try {\r\n      const raw = localStorage.getItem(HISTORY_KEY);\r\n      return raw ? JSON.parse(raw) : [];\r\n    } catch (e) {\r\n      return [];\r\n    }\r\n  }\r\n\r\n  static save(list) {\r\n    localStorage.setItem(HISTORY_KEY, JSON.stringify(list));\r\n    ReservationHistoryService.notifyUpdated();\r\n  }\r\n\r\n  static notifyUpdated() {\r\n    try {\r\n      window.dispatchEvent(new Event('reservationHistoryUpdated'));\r\n    } catch (_) {}\r\n  }\r\n\r\n  static generateCode() {\r\n    return 'RSV-' + Math.random().toString(36).substring(2, 8).toUpperCase();\r\n  }\r\n\r\n  static addReservation({ items, subtotal }) {\r\n    const list = ReservationHistoryService.list();\r\n    const code = ReservationHistoryService.generateCode();\r\n    const id = `${Date.now()}`;\r\n    const date = new Date().toISOString();\r\n    const reservation = {\r\n      id,\r\n      code,\r\n      date,\r\n      status: 'Processing',\r\n      deliveryFee: 0,\r\n      subtotal,\r\n      total: subtotal,\r\n      items: items.map(i => ({\r\n        id: i.id,\r\n        name: i.name,\r\n        price: i.price,\r\n        qty: i.qty || 1,\r\n        imagePath: i.imagePath\r\n      }))\r\n    };\r\n    list.unshift(reservation);\r\n    ReservationHistoryService.save(list);\r\n\r\n    // Simulate status progression\r\n    setTimeout(() => {\r\n      ReservationHistoryService.updateStatus(id, 'Confirmed');\r\n    }, 5000);\r\n    setTimeout(() => {\r\n      ReservationHistoryService.updateStatus(id, 'Ready for Pickup');\r\n    }, 12000);\r\n\r\n    return reservation;\r\n  }\r\n\r\n  static updateStatus(id, status) {\r\n    const list = ReservationHistoryService.list();\r\n    const idx = list.findIndex(r => r.id === id);\r\n    if (idx >= 0) {\r\n      list[idx] = { ...list[idx], status };\r\n      ReservationHistoryService.save(list);\r\n    }\r\n  }\r\n\r\n  static getByCode(code) {\r\n    return ReservationHistoryService.list().find(r => r.code === code) || null;\r\n  }\r\n}\r\n\r\nexport default ReservationHistoryService;\r\n\r\n\r\n"],"mappings":"AAAA,MAAMA,WAAW,GAAG,qBAAqB;AAEzC,MAAMC,yBAAyB,CAAC;EAC9B,OAAOC,IAAIA,CAAA,EAAG;IACZ,IAAI;MACF,MAAMC,GAAG,GAAGC,YAAY,CAACC,OAAO,CAACL,WAAW,CAAC;MAC7C,OAAOG,GAAG,GAAGG,IAAI,CAACC,KAAK,CAACJ,GAAG,CAAC,GAAG,EAAE;IACnC,CAAC,CAAC,OAAOK,CAAC,EAAE;MACV,OAAO,EAAE;IACX;EACF;EAEA,OAAOC,IAAIA,CAACP,IAAI,EAAE;IAChBE,YAAY,CAACM,OAAO,CAACV,WAAW,EAAEM,IAAI,CAACK,SAAS,CAACT,IAAI,CAAC,CAAC;IACvDD,yBAAyB,CAACW,aAAa,CAAC,CAAC;EAC3C;EAEA,OAAOA,aAAaA,CAAA,EAAG;IACrB,IAAI;MACFC,MAAM,CAACC,aAAa,CAAC,IAAIC,KAAK,CAAC,2BAA2B,CAAC,CAAC;IAC9D,CAAC,CAAC,OAAOC,CAAC,EAAE,CAAC;EACf;EAEA,OAAOC,YAAYA,CAAA,EAAG;IACpB,OAAO,MAAM,GAAGC,IAAI,CAACC,MAAM,CAAC,CAAC,CAACC,QAAQ,CAAC,EAAE,CAAC,CAACC,SAAS,CAAC,CAAC,EAAE,CAAC,CAAC,CAACC,WAAW,CAAC,CAAC;EAC1E;EAEA,OAAOC,cAAcA,CAAC;IAAEC,KAAK;IAAEC;EAAS,CAAC,EAAE;IACzC,MAAMvB,IAAI,GAAGD,yBAAyB,CAACC,IAAI,CAAC,CAAC;IAC7C,MAAMwB,IAAI,GAAGzB,yBAAyB,CAACgB,YAAY,CAAC,CAAC;IACrD,MAAMU,EAAE,GAAG,GAAGC,IAAI,CAACC,GAAG,CAAC,CAAC,EAAE;IAC1B,MAAMC,IAAI,GAAG,IAAIF,IAAI,CAAC,CAAC,CAACG,WAAW,CAAC,CAAC;IACrC,MAAMC,WAAW,GAAG;MAClBL,EAAE;MACFD,IAAI;MACJI,IAAI;MACJG,MAAM,EAAE,YAAY;MACpBC,WAAW,EAAE,CAAC;MACdT,QAAQ;MACRU,KAAK,EAAEV,QAAQ;MACfD,KAAK,EAAEA,KAAK,CAACY,GAAG,CAACC,CAAC,KAAK;QACrBV,EAAE,EAAEU,CAAC,CAACV,EAAE;QACRW,IAAI,EAAED,CAAC,CAACC,IAAI;QACZC,KAAK,EAAEF,CAAC,CAACE,KAAK;QACdC,GAAG,EAAEH,CAAC,CAACG,GAAG,IAAI,CAAC;QACfC,SAAS,EAAEJ,CAAC,CAACI;MACf,CAAC,CAAC;IACJ,CAAC;IACDvC,IAAI,CAACwC,OAAO,CAACV,WAAW,CAAC;IACzB/B,yBAAyB,CAACQ,IAAI,CAACP,IAAI,CAAC;;IAEpC;IACAyC,UAAU,CAAC,MAAM;MACf1C,yBAAyB,CAAC2C,YAAY,CAACjB,EAAE,EAAE,WAAW,CAAC;IACzD,CAAC,EAAE,IAAI,CAAC;IACRgB,UAAU,CAAC,MAAM;MACf1C,yBAAyB,CAAC2C,YAAY,CAACjB,EAAE,EAAE,kBAAkB,CAAC;IAChE,CAAC,EAAE,KAAK,CAAC;IAET,OAAOK,WAAW;EACpB;EAEA,OAAOY,YAAYA,CAACjB,EAAE,EAAEM,MAAM,EAAE;IAC9B,MAAM/B,IAAI,GAAGD,yBAAyB,CAACC,IAAI,CAAC,CAAC;IAC7C,MAAM2C,GAAG,GAAG3C,IAAI,CAAC4C,SAAS,CAACC,CAAC,IAAIA,CAAC,CAACpB,EAAE,KAAKA,EAAE,CAAC;IAC5C,IAAIkB,GAAG,IAAI,CAAC,EAAE;MACZ3C,IAAI,CAAC2C,GAAG,CAAC,GAAG;QAAE,GAAG3C,IAAI,CAAC2C,GAAG,CAAC;QAAEZ;MAAO,CAAC;MACpChC,yBAAyB,CAACQ,IAAI,CAACP,IAAI,CAAC;IACtC;EACF;EAEA,OAAO8C,SAASA,CAACtB,IAAI,EAAE;IACrB,OAAOzB,yBAAyB,CAACC,IAAI,CAAC,CAAC,CAAC+C,IAAI,CAACF,CAAC,IAAIA,CAAC,CAACrB,IAAI,KAAKA,IAAI,CAAC,IAAI,IAAI;EAC5E;AACF;AAEA,eAAezB,yBAAyB","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}